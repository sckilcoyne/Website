"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{3140:(e,s,t)=>{t.d(s,{R:()=>r});let a={};function r(){return a}},8672:(e,s,t)=>{t.d(s,{A:()=>Y});var a=t(7876),r=t(4232),l=t(1324),c=t.n(l);t(1266);let n={src:"/_next/static/media/Icon_LTS1.97e6aed7.svg"},i={src:"/_next/static/media/Icon_LTS2.0116cc2c.svg"},o={src:"/_next/static/media/Icon_LTS3.a74259a9.svg"},d={src:"/_next/static/media/Icon_LTS4.0b625a74.svg"},h={src:"/_next/static/media/Text_LTS1.6f6a7568.svg"},u={src:"/_next/static/media/Text_LTS2.311488c1.svg"},x={src:"/_next/static/media/Text_LTS3.79106d52.svg"},m={src:"/_next/static/media/Text_LTS4.18ad8054.svg"},j={src:"/_next/static/media/BikeStressMap.9b50e44a.svg"};console.log("Legend loaded");let b=e=>{let{colorScale:s,lts_display:t,lts1_display:r,lts2_display:l,lts3_display:c,lts4_display:b,handleLTS1:p,handleLTS2:g,handleLTS3:N,handleLTS4:y}=e,f={borderColor:s[0]},S={borderColor:s[1]},v={borderColor:s[2]},k={borderColor:s[3]},w={borderColor:"white"};return(0,a.jsx)("div",{className:"legend grid-container",children:t&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"legend-header-hover",children:(0,a.jsx)("img",{src:j.src,alt:"Legend",className:"hover-image"})}),(0,a.jsxs)("button",{className:"legend-row",style:r?f:w,onClick:p,children:[(0,a.jsxs)("div",{className:"legend-icon",children:[(0,a.jsx)("img",{src:n.src,alt:"LTS 1",className:"default-image"}),(0,a.jsx)("img",{src:n.src,alt:"LTS 1",className:"hover-image"})]}),(0,a.jsx)("div",{className:"legend-text",children:(0,a.jsx)("img",{src:h.src,alt:"Carefree riding",className:"hover-image"})})]}),(0,a.jsxs)("button",{className:"legend-row",style:l?S:w,onClick:g,children:[(0,a.jsxs)("div",{className:"legend-icon",children:[(0,a.jsx)("img",{src:i.src,alt:"LTS 2",className:"default-image"}),(0,a.jsx)("img",{src:i.src,alt:"LTS 2",className:"hover-image"})]}),(0,a.jsx)("div",{className:"legend-text",children:(0,a.jsx)("img",{src:u.src,alt:"Easy going riding",className:"hover-image"})})]}),(0,a.jsxs)("button",{className:"legend-row",style:c?v:w,onClick:N,children:[(0,a.jsxs)("div",{className:"legend-icon",children:[(0,a.jsx)("img",{src:o.src,alt:"LTS 3",className:"default-image"}),(0,a.jsx)("img",{src:o.src,alt:"LTS 3",className:"hover-image"})]}),(0,a.jsx)("div",{className:"legend-text",children:(0,a.jsx)("img",{src:x.src,alt:"Stressful riding",className:"hover-image"})})]}),(0,a.jsxs)("button",{className:"legend-row",style:b?k:w,onClick:y,children:[(0,a.jsxs)("div",{className:"legend-icon",children:[(0,a.jsx)("img",{src:d.src,alt:"LTS 4",className:"default-image"}),(0,a.jsx)("img",{src:d.src,alt:"LTS 4",className:"hover-image"})]}),(0,a.jsx)("div",{className:"legend-text",children:(0,a.jsx)("img",{src:m.src,alt:"White knuckle riding",className:"hover-image"})})]})]})})},p=e=>{var s,t,a,r;let{start:l,end:c,inverse:n=!1}=e;function i(e){return e*Math.PI/180}"number"==typeof l[0]?(s=l[0],t=c[0],a=l[1],r=c[1]):"object"==typeof l[0]&&(s=l[0][0],t=c[0][0],a=l[0][1],r=c[0][1]),a=i(a),s=i(s),r=i(r);let o=Math.floor(((180*Math.atan2(Math.sin((t=i(t))-s)*Math.cos(r),Math.cos(a)*Math.sin(r)-Math.sin(a)*Math.cos(r)*Math.cos(t-s))/Math.PI+360)%360+22.5)/45);switch(n&&(o-=4),o){case 0:case 8:case -8:o="North";break;case 1:case -7:o="NorthEast";break;case 2:case -6:o="East";break;case 3:case -5:o="SouthEast";break;case 4:case -4:o="South";break;case 5:case -3:o="SouthWest";break;case 6:case -2:o="West";break;case 7:case -1:o="NorthWest"}return o},g=e=>{let{ltsValue:s}=e,t="Unknown LTS Value: "+s;switch(Number(s)){case 1:t="1 - Carefree";break;case 2:t="2 - Easygoing";break;case 3:t="3 - Tense";break;case 4:t="4 - White Knuckles";break;case 0:t="Biking not permitted"}return t},N=e=>"string"==typeof e?e:"boolean"==typeof e||"number"==typeof e?e.toString():void 0===e?"n/a":typeof e;console.log("InfoSimple loaded");let y=e=>{var s,t;let{selectedFeature:r}=e;console.log("InfoSimple/selectedFeature:",r);let{name:l,LTS:c,LTS_fwd:n,LTS_rev:i,bike_allowed_fwd:o,bike_allowed_rev:d,bike_lane_fwd:h,bike_lane_rev:u,separation_fwd:x,separation_rev:m,oneway:j,osmid:b,speed:y,speed_rule:f}=r.properties,S=r.geometry.coordinates[0],v=r.geometry.coordinates.at(-1);"string"==typeof o?(s="True"===o,t="True"===d):"boolean"==typeof o&&(s=o,t=d);let k=(0,a.jsx)(p,{start:S,end:v}),w=(0,a.jsx)(p,{start:S,end:v,inverse:!0}),L=N(h),_=N(u),T=N(x),C=N(m);return console.log("name:",l,"| osmid",b,typeof b),console.log("bike_allowed_fwd:",o,typeof o," | bike_allowed_rev:",d,typeof d),console.log("allowed_fwd:",s,typeof s," | allowed_rev:",t,typeof t),console.log("bike_lane_fwd:",h,typeof h," | bike_lane_rev:",u,typeof u),console.log("separation_fwd:",x,typeof x," | separation_rev:",m,typeof m),console.log("LTS:",c,typeof c,"| LTS_fwd:",n,typeof n," | LTS_rev:",i,typeof i),console.log("oneway:",j,typeof j),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"tableStreetName",children:l}),(0,a.jsx)("div",{className:"tableContainer",children:(0,a.jsxs)("table",{children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("th",{children:w}),s&&(0,a.jsx)("th",{children:k})]})}),(0,a.jsxs)("tbody",{className:"tableBox",children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Biking Stress Level"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:(0,a.jsx)(g,{ltsValue:i})}),s&&(0,a.jsx)("td",{className:"tableValue",children:(0,a.jsx)(g,{ltsValue:n})})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Bike Lane"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:_}),s&&(0,a.jsx)("td",{className:"tableValue",children:L})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Bike Lane Separation"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:C}),s&&(0,a.jsx)("td",{className:"tableValue",children:T})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Prevailing Automobile Speed"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableValue",colSpan:"2",children:y})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"notes",colSpan:"2",children:f})})]})]})})]})};console.log("InfoDetail loaded");let f=e=>{var s,t;let{selectedFeature:r}=e;console.log("InfoDetail/selectedFeature:",r);let{name:l,highway:c,LTS_fwd:n,LTS_rev:i,bike_allowed_fwd:o,bike_allowed_rev:d,osmid:h,oneway:u,street_narrow_wide:x,width_street:m,width_street_rule:j,width_parking_rev:b,width_parking_fwd:g,lane_count:y,lane_count_rule:f,parking_fwd:S,parking_rev:v,speed:k,speed_rule:w,centerline:L,centerline_rule:_,ADT:T,ADT_rule:C}=r.properties,D=r.geometry.coordinates[0],V=r.geometry.coordinates[1],B="https://www.openstreetmap.org/way/"+h.toString();return"string"==typeof o?(s="True"===o,t="True"===d):"boolean"==typeof o&&(s=o,t=d),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"tableStreetName",children:l}),(0,a.jsx)("div",{className:"tableContainer",children:(0,a.jsxs)("table",{className:"tableAdvancedMode",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("th",{children:(0,a.jsx)(p,{start:D,end:V,inverse:!0})}),s&&(0,a.jsx)("th",{children:(0,a.jsx)(p,{start:D,end:V})})]})}),(0,a.jsxs)("tbody",{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"LTS"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:(0,a.jsx)("b",{children:i})}),s&&(0,a.jsx)("td",{className:"tableValue",children:(0,a.jsx)("b",{children:n})})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableSection",colSpan:"2",children:"Bike Infrastructure"})}),(0,a.jsx)(e=>{let{data:r}=e,{highway:l,bike_lane_fwd:c,bike_lane_rev:n,separation_fwd:i,separation_rev:o,bike_width_fwd:d,bike_width_rev:h,bike_width_rule_fwd:u,bike_width_rule_rev:x,buffer_fwd:m,buffer_rev:j,buffer_rule_fwd:b,buffer_rule_rev:p,bike_reach_fwd:g,bike_reach_rev:y}=r;console.log("bike_lane_fwd:",c,"bike_lane_rev:",n);let f="";return"no"==c&&"no"==n&&("footway"==l||"cycleway"==l||"service"==l)?(0,a.jsx)(a.Fragment,{}):(f=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Bike Lane"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:N(n)}),s&&(0,a.jsx)("td",{className:"tableValue",children:N(c)})]})]}),"no"==c&&"no"==n&&"footway"!=l)?f:(0,a.jsxs)(a.Fragment,{children:[f,(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"notes",children:o}),s&&(0,a.jsx)("td",{className:"notes",children:i})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Bike Lane Width"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:Number(h).toFixed(1)}),s&&(0,a.jsx)("td",{className:"tableValue",children:Number(d).toFixed(1)})]}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"notes",children:x}),s&&(0,a.jsx)("td",{className:"notes",children:u})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Bike Lane Buffer"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:Number(j).toFixed(1)}),s&&(0,a.jsx)("td",{className:"tableValue",children:Number(m).toFixed(1)})]}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"notes",children:p}),s&&(0,a.jsx)("td",{className:"notes",children:b})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Bike Lane Reach"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:Number(y).toFixed(1)}),s&&(0,a.jsx)("td",{className:"tableValue",children:Number(g).toFixed(1)})]})]})},{data:r.properties}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableSection",colSpan:"2",children:"Street Design for Cars"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Road Designation"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableValue",colSpan:"2",children:c})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Oneway"})}),(0,a.jsx)("tr",{children:(0,a.jsxs)("td",{className:"tableValue",colSpan:"2",children:[u," ",x]})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Street Width"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableValue",colSpan:"2",children:Number(m).toFixed(1)})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"notes",colSpan:"2",children:j})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Parking Width"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:Number(b).toFixed(1)}),s&&(0,a.jsx)("td",{className:"tableValue",children:Number(g).toFixed(1)})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Lane Count"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableValue",colSpan:"2",children:y})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"notes",colSpan:"2",children:f})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Parking"})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:v}),s&&(0,a.jsx)("td",{className:"tableValue",children:S})]}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Prevailing Speed"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableValue",colSpan:"2",children:k})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"notes",colSpan:"2",children:w})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Centerline"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableValue",colSpan:"2",children:L})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"notes",colSpan:"2",children:_})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"Average Daily Traffic (ADT)"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableValue",colSpan:"2",children:T})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"notes",colSpan:"2",children:C})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableSection",colSpan:"2",children:"LTS Calculations"})}),(0,a.jsx)(e=>{let{data:r}=e,{LTS_bike_access_fwd:l,LTS_bike_access_rev:c,LTS_mixed_fwd:n,LTS_mixed_rev:i,LTS_bikelane_noparking_rev:o,LTS_bikelane_noparking_fwd:d,LTS_bikelane_yesparking_rev:h,LTS_bikelane_yesparking_fwd:u}=r,x=[];for(let e of[["Mixed Traffic",i,n],["Biking Access",c,l],["Bike lane without street parking",o,d],["Bike lane with street parking",h,u]])console.log(e[0],void 0!==e[1],void 0!==e[2]),(void 0!==e[1]||void 0!==e[2])&&x.push([(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:e[0]})}),(0,a.jsxs)("tr",{children:[t&&(0,a.jsx)("td",{className:"tableValue",children:e[1]}),s&&(0,a.jsx)("td",{className:"tableValue",children:e[2]})]})]})]);return console.log("lts row",x),x},{data:r.properties}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableSection",colSpan:"2",children:"Technical Info"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableDescription",colSpan:"2",children:"OSMid"})}),(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"tableValue",colSpan:"2",children:(0,a.jsx)("a",{href:B,target:"_blank",children:h})})})]})]})})]})};console.log("InfoBikeParking loaded");let S=e=>{let{selectedFeature:s}=e;console.log("InfoBikeParking/selectedFeature:",s);let{bicycle_parking:t,capacity:r,covered:l,id:c,indoor:n,access:i}=s.properties,o="https://www.openstreetmap.org/"+c.toString();return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"tableStreetName",children:"Bike Parking Details"}),(0,a.jsx)("div",{className:"tableContainer",children:(0,a.jsx)("table",{children:(0,a.jsxs)("tbody",{className:"tableBox",children:[t&&(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Parking Style"}),(0,a.jsx)("td",{className:"tableValue",children:t})]}),r&&(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Capacity"}),(0,a.jsx)("td",{className:"tableValue",children:r})]}),l&&(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Covered?"}),(0,a.jsx)("td",{className:"tableValue",children:l})]}),n&&(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Indoor?"}),(0,a.jsx)("td",{className:"tableValue",children:n})]}),i&&(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Access"}),(0,a.jsx)("td",{className:"tableValue",children:i})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"OSM id"}),(0,a.jsx)("td",{className:"tableValue",children:(0,a.jsx)("a",{href:o,target:"_blank",children:c.substring(c.search("/")+1)})})]})]})})})]})};console.log("InfoBluebikes loaded");let v=e=>{let{selectedFeature:s}=e;console.log("InfoBluebikes/selectedFeature:",s);let{name:t,capacity:r,num_bikes_available:l,num_bikes_disabled:c,num_docks_available:n,num_docks_disabled:i,num_ebikes_available:o}=s.properties;return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"tableStreetName",children:t}),(0,a.jsx)("div",{className:"tableContainer",children:(0,a.jsx)("table",{children:(0,a.jsxs)("tbody",{className:"tableBox",children:[(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Capacity"}),(0,a.jsx)("td",{className:"tableValue",children:r})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Available Docks"}),(0,a.jsx)("td",{className:"tableValue",children:n})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Available Bikes"}),(0,a.jsx)("td",{className:"tableValue",children:l})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Available E-bikes"}),(0,a.jsx)("td",{className:"tableValue",children:o})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Disabled Bikes"}),(0,a.jsx)("td",{className:"tableValue",children:c})]}),(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"tableDescription",children:"Disabled Docks"}),(0,a.jsx)("td",{className:"tableValue",children:i})]})]})})})]})};var k=t(776);function w(e,s){let t;if(console.log(e,s),"Yes"==s)t="✔️ All "+e;else if("Partial"==s)t="⚠️ Some "+e;else{if("No"!=s)return console.log("return nothing"),"";t="❌ No "+e}return t}console.log("InfoIntersections loaded");let L=e=>{let{selectedFeature:s}=e;console.log("InfoIntersections/selectedFeature:",s);let{name:t,ProtectedBikeLanes:r,ProtectedCorners:l,DaylitCrosswalks:c,projectName:n,projectLink:i,notes:o,lastUpdated:d}=s.properties,{coordinates:h}=s._geometry,[u,x]=h;return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"tableStreetName",children:t}),(0,a.jsx)("h2",{className:"tableSubheading",children:"Intersection Audit Details"}),r&&(0,a.jsx)("p",{children:w("Bike Lanes Separated",r)}),l&&(0,a.jsx)("p",{children:w("Corners Protected",l)}),c&&(0,a.jsx)("p",{children:w("Crosswalks Daylit",c)}),n&&(0,a.jsxs)("p",{children:["Project: ",(0,a.jsx)(k.N_,{to:i,children:n})]}),o&&(0,a.jsx)("p",{children:o}),(0,a.jsx)("p",{children:(0,a.jsx)(k.N_,{to:"https://www.google.com/maps/@?api=1&map_action=pano&viewpoint="+x+"%2C"+u,children:"Google Streetview"})}),(0,a.jsxs)("p",{children:["Audit Last Updated: ",d]}),(0,a.jsx)("p",{children:(0,a.jsx)(k.N_,{to:"",children:"Let us know if something looks wrong"})})]})};console.log("SideBar loaded");let _=e=>{let{advancedMode:s}=e;return s?"Show Fewer Details":"Show Advanced Details"},T=e=>{let{selectedFeature:s,selectedFeatureType:t,advancedMode:r}=e;return"lts"==t?r?(console.log("return advanced sidebar"),(0,a.jsx)("div",{className:"advancedMode",children:(0,a.jsx)(f,{selectedFeature:s})})):(console.log("return simple sidebar"),(0,a.jsx)("div",{className:"basicMode",children:(0,a.jsx)(y,{selectedFeature:s})})):"bikeParking"==t?(console.log("return bike parking sidebar"),(0,a.jsx)("div",{className:"basicMode",children:(0,a.jsx)(S,{selectedFeature:s})})):"bluebikeStation"==t?(console.log("return bluebike Station sidebar"),(0,a.jsx)("div",{className:"basicMode",children:(0,a.jsx)(v,{selectedFeature:s})})):"intersections"==t?(console.log("return intersections sidebar"),(0,a.jsx)("div",{className:"basicMode",children:(0,a.jsx)(L,{selectedFeature:s})})):void 0},C=e=>{let{selectedFeature:s,selectedFeatureType:t,zoom:r,zoomLimit:l,advancedMode:c=!1}=e;return(s&&console.log("SideBar/selectedFeature",s),t&&console.log("SideBar/selectedFeatureType",t),r<l)?(0,a.jsx)("div",{id:"sidebar",className:"sidebar",children:(0,a.jsx)("p",{children:"Zoom in to select a street segment and learn more about it"})}):void 0==s?(0,a.jsx)("div",{id:"sidebar",className:"sidebar",children:(0,a.jsx)("p",{children:"Click a street segment to learn more about it"})}):(0,a.jsx)("div",{id:"sidebar",className:"sidebar",children:(0,a.jsx)(T,{selectedFeature:s,selectedFeatureType:t,advancedMode:c})})};var D=t(4330),V=t(4488),B=t.n(V);async function F(){console.log("Fetching bike parking through overpass");let e=(0,D._G)('[out:json][timeout:25]; \n                  (\n                    area["wikipedia"="en:Boston"];\n                    area["wikipedia"="en:Cambridge, Massachusetts"];\n                    area["wikipedia"="en:Brookline, Massachusetts"];\n                    area["wikipedia"="en:Somerville, Massachusetts"];\n                  )->.searchArea; nwr["amenity"="bicycle_parking"](area.searchArea); \n                out geom;'),s=B()(await e);return console.log(s),s}var M=t(5545),I=t.n(M);async function P(e,s){let t=await e.json(),a=await s.json(),r=I().search(t,"{type: `FeatureCollection`, features: data.stations[*].{id: station_id, geometry: {type: `Point`, coordinates: [lon, lat]}, properties: @}}"),l=new Map(I().search(a,"{type: `FeatureCollection`, features: data.stations[*].{id: station_id, properties: @}}").features.map(e=>{let{id:s,properties:t}=e;return[s,t]}));return r.features=r.features.map(e=>{let{id:s,geometry:t,properties:a}=e;return{id:s,geometry:t,properties:Object.assign({},a,l.get(s))}}),r}async function A(){console.log("Fetching BlueBike data");let e=await fetch("https://gbfs.lyft.com/gbfs/1.1/bos/en/station_information.json",{cors:!0}),s=await fetch("https://gbfs.lyft.com/gbfs/1.1/bos/en/station_status.json",{cors:!0});return P(await e,await s)}var R=t(7006),E=t.n(R);async function O(){let e;console.log("Fetching intersection data from google");let s=await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vT-8X_V7FUnDhcID9UGouljx_X0rMg5PAdM7lLwl1PmKXlB43sVIsurplO3qnjN3OE3_YEar4qUZzm7/pub?output=csv"),t=await s.text();return console.log("CSV retrieved"),E().csv2geojson(await t,{latfield:"lat",lonfield:"lon",delimiter:","},function(s,t){return e=t}),await e}function U(e,s){e.current.on("mouseenter",s,()=>{e.current.getCanvas().style.cursor="pointer"}),e.current.on("mouseleave",s,()=>{e.current.getCanvas().style.cursor=""})}function z(e,s,t,a,r){e.current.on("click",s,l=>{console.log("MapLayers/click/e.features[0]",l.features[0]),console.log("MapLayers/click/e.features[0].geometry.coordinates",l.features[0].geometry.coordinates),a(l.features[0]),r(t),void 0!==e.current.getLayer(s+"-selected")&&e.current.setFilter(s+"-selected",["in","osmid",l.features[0].id])})}function W(e,s,t,a,r,l){void 0===e.current.getSource("LTS_source")&&e.current.addSource("LTS_source",{type:"vector",url:"mapbox://skilcoyne.stressmap_tiles"}),void 0===e.current.getLayer(s)&&e.current.addLayer({id:s,type:"line",source:"LTS_source","source-layer":"lts",slot:"middle",paint:{"line-color":["match",["get","LTS"],1,t[0],2,t[1],3,t[2],4,t[3],t[4]],"line-width":a},layout:{visibility:"visible"},filter:["in","LTS",1,2,3,4]}),void 0===e.current.getLayer(s+"-selected")&&e.current.addLayer({id:s+"-selected",type:"line",source:"LTS_source","source-layer":"lts",slot:"middle",paint:{"line-color":["match",["get","LTS"],1,t[0],2,t[1],3,t[2],4,t[3],t[4]],"line-width":3*a},filter:["in","osmid",""],layout:{visibility:"visible"}}),U(e,s),z(e,s,"lts",r,l)}function Z(e,s,t,a,r,l){O(e).then(t=>{void 0===e.current.getSource("intersections")&&e.current.addSource("intersections",{type:"geojson",data:t}),void 0===e.current.getLayer(s)&&(e.current.addLayer({id:s,type:"circle",source:"intersections",paint:{"circle-radius":["interpolate",["exponential",1.75],["zoom"],12,6,18,20],"circle-stroke-width":1,"circle-color":["match",["get","score"],"6",a[0],"5",a[1],"4",a[2],"3",a[2],"2",a[3],"1",a[3],"0",a[3],a[3]],"circle-stroke-color":"white"},layout:{visibility:"visible"}}),U(e,s),z(e,s,"intersections",r,l))})}function q(e,s,t,a,r){F(e).then(l=>{void 0===e.current.getSource("bike-parking")&&e.current.addSource("bike-parking",{type:"geojson",data:l}),void 0===e.current.getLayer(s)&&e.current.addLayer({id:s,type:"circle",source:"bike-parking",paint:{"circle-radius":3,"circle-stroke-width":1,"circle-color":t[0],"circle-stroke-color":"white"},layout:{visibility:"visible"}}),U(e,s),z(e,s,"bikeParking",a,r)})}function X(e,s,t,a){A().then(r=>{console.log("bluebikeStationsGeojson loaded"),e.current.loadImage("/bluebike_classic.png",(l,c)=>{if(l)throw l;e.current.addImage("bluebike_classic_img",c),void 0===e.current.getSource("bluebike-stations")&&e.current.addSource("bluebike-stations",{type:"geojson",data:r}),void 0===e.current.getLayer(s)&&e.current.addLayer({id:s,type:"symbol",source:"bluebike-stations",layout:{visibility:"visible","icon-image":"bluebike_classic_img","icon-size":["interpolate",["linear"],["zoom"],12,.5,18,2],"icon-allow-overlap":!0}}),U(e,s),z(e,s,"bluebikeStation",t,a)})})}let G=[-71.0809,42.3473],J=[[-71.2,42.18],[-70.9,42.46]],Q=["#007191","#62c8d3","#f47a00","#d31f11","grey"],Y=function(){let[e,s]=(0,r.useState)(),[t,l]=(0,r.useState)(),[n,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!0),[h,u]=(0,r.useState)(!1),[x,m]=(0,r.useState)(!1),[j,p]=(0,r.useState)(!1),g=(0,r.useRef)(),N=(0,r.useRef)(),y=(0,r.useRef)(),f=(0,r.useRef)();g.current=o,N.current=h,y.current=x,f.current=j,console.log("Map() |","displayLTSRef.current",g.current,"displayIntersectionsRef.current",N.current,"displayBikeParkingRef.current",y.current,"displayBluebikeStationsRef.current",f.current);let[S,v]=(0,r.useState)(!0),[k,w]=(0,r.useState)(!0),[L,T]=(0,r.useState)(!0),[D,V]=(0,r.useState)(!0),B=(0,r.useRef)(),F=(0,r.useRef)(),M=(0,r.useRef)(),I=(0,r.useRef)();B.current=S,F.current=k,M.current=L,I.current=D;var P="lts-layer",A="intersections-layer",R="bike_parking-layer",E="bluebike-layer";let O=(e,t,a,r)=>{console.log("loadLayers State",o,h,x,j),console.log("loadLayers Ref",g.current,N.current,y.current,f.current),g.current&&(W(U,e,Q,4,s,l),B.current||ee(1),F.current||ee(2),M.current||ee(3),I.current||ee(4)),y.current&&q(U,t,Q,s,l),f.current&&X(U,a,Q,s,l),N.current&&Z(U,r,N,Q,s,l)},U=(0,r.useRef)(),z=(0,r.useRef)(),[Y,K]=(0,r.useState)(G),[H,$]=(0,r.useState)(12),ee=e=>{let s=U.current.getFilter(P);if(s.includes(e)){let t=s.indexOf(e);s.splice(t,1)}else s.push(e);U.current.setFilter(P,s)};(0,r.useEffect)(()=>(c().accessToken="pk.eyJ1Ijoic2tpbGNveW5lIiwiYSI6ImNseTd2cXpwOTA5MnUya3E2ejBkN2ttOW8ifQ.TN39Bd_yu_SqMsu-IW4FKQ",U.current=new(c()).Map({container:z.current,center:Y,zoom:H,minZoom:12,maxZoom:20,maxBounds:J,style:"mapbox://styles/mapbox/standard",config:{basemap:{lightPreset:"day",showPlaceLabels:!1,showPointOfInterestLabels:!1,theme:"monochrome",show3dObjects:!1,showTransitLabels:!0,showRoadLabels:!0}}}),U.current.on("load",function(){O(P,R,E,A),U.current.on("move",()=>{let e=U.current.getCenter(),s=U.current.getZoom();K([e.lng,e.lat]),$(s)}),U.current.addControl(new(c()).FullscreenControl)}),U.current.on("zoom",()=>{let e="mapbox://styles/mapbox/standard",s={basemap:{lightPreset:"day",showPlaceLabels:!1,showPointOfInterestLabels:!1,theme:"monochrome",show3dObjects:!1,showTransitLabels:!0,showRoadLabels:!0}};if(console.log("zoom:",U.current.getZoom(),"| displayLTS:",g.current,"displayIntersections:",N.current,"displayBikeParking:",y.current,"displayBluebikeStations:",f.current),U.current.isStyleLoaded()){let t=U.current.getStyle().imports[0].data.name,a=U.current.getZoom();N.current?a>16&&"Mapbox Standard"==t?U.current.setStyle("mapbox://styles/mapbox/standard-satellite"):a<16&&"Mapbox Standard Satellite"==t&&U.current.setStyle(e,{config:s}):"Mapbox Standard"!=t&&U.current.setStyle(e,{config:s})}}),U.current.on("style.load",()=>{O(P,R,E,A)}),()=>{U.current.remove()}));let es=(e,t,a,r)=>{console.log(r+" checkbox changed to "+e),t(e=>!e),e?(void 0===U.current.getLayer(r)&&(r==A?Z(U,A,N,Q,s,l):r==R?q(U,R,Q,s,l):r==E?X(U,E,Q,s,l):r==P&&W(U,P,Q,4,s,l)),console.log("Turning on "+r),U.current.setLayoutProperty(r,"visibility","visible"),void 0!==U.current.getLayer(r+"selected")&&U.current.setLayoutProperty(r+"selected","visibility","visible")):(console.log("Turning off "+r),U.current.setLayoutProperty(r,"visibility","none"),void 0!==U.current.getLayer(r+"selected")&&U.current.setLayoutProperty(r+"selected","visibility","none"))};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{id:"map-container",ref:z,children:[(0,a.jsx)(b,{colorScale:Q,lts_display:o,lts1_display:B.current,lts2_display:F.current,lts3_display:M.current,lts4_display:I.current,handleLTS1:()=>{console.log("displayLTS1 switched from",B.current),v(e=>!e),ee(1)},handleLTS2:()=>{console.log("displayLTS2 switched from",F.current),w(e=>!e),ee(2)},handleLTS3:()=>{console.log("displayLTS3 switched from",M.current),T(e=>!e),ee(3)},handleLTS4:()=>{console.log("displayLTS4 switched from",I.current),V(e=>!e),ee(4)}}),(0,a.jsx)("button",{className:"reset-button",onClick:()=>{U.current.flyTo({center:G,zoom:12}),s(),l(),U.current.setFilter(P+"-selected",["in","osmid",""])},children:"Reset"}),(0,a.jsx)("button",{className:"advanced-button",onClick:()=>{console.log("advancedMode switched from",n),i(e=>!e)},children:(0,a.jsx)(_,{advancedMode:n})}),(0,a.jsxs)("div",{id:"options-menu",children:[(0,a.jsx)("h1",{id:"options-title",children:"Map Features"}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"options-layer",children:[(0,a.jsx)("input",{type:"checkbox",name:"ltsCheckbox",checked:g.current,onChange:e=>es(e.target.checked,d,g,P)}),"Stress Map"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"options-layer",children:[(0,a.jsx)("input",{type:"checkbox",name:"bikeParkingCheckbox",checked:N.current,onChange:e=>es(e.target.checked,u,N,A)}),"Intersection Audits"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"options-layer",children:[(0,a.jsx)("input",{type:"checkbox",name:"bikeParkingCheckbox",checked:y.current,onChange:e=>es(e.target.checked,m,y,R)}),"Bike Parking"]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("label",{className:"options-layer",children:[(0,a.jsx)("input",{type:"checkbox",name:"bluebikeStationCheckbox",checked:f.current,onChange:e=>es(e.target.checked,p,f,E)}),"BlueBike Stations"]})})]}),(0,a.jsx)(C,{selectedFeature:e,selectedFeatureType:t,zoom:H,zoomLimit:12,advancedMode:n})]})})}},9744:(e,s,t)=>{t.d(s,{A:()=>d});var a=t(7876);let r={src:"/_next/static/media/labs_wordmark.9ddc68f7.svg"};var l=t(8230),c=t.n(l);function n(){return(0,a.jsx)("div",{id:"header_stripe",children:(0,a.jsx)(c(),{href:"/",children:(0,a.jsx)("img",{src:r.src,className:"labs_wordmark",alt:"BCU Labs"})})})}function i(){return(0,a.jsx)("div",{className:"Pad",children:(0,a.jsx)(c(),{href:"https://secure.everyaction.com/mfRgF-hjuEueYqUtvn9Jeg2",children:(0,a.jsx)("button",{className:"Button Donate",children:"Donate"})})})}function o(){return(0,a.jsxs)("div",{className:"foot",children:[(0,a.jsxs)("div",{className:"text",children:[(0,a.jsx)(c(),{href:"/",children:"BCU Labs"})," is a volunteer-led project of ",(0,a.jsx)(c(),{href:"https://bostoncyclistsunion.org/",children:"Boston Cyclists Union"})]}),(0,a.jsx)("div",{className:"text",children:(0,a.jsx)(c(),{href:"https://docs.google.com/forms/d/e/1FAIpQLSefzxEQ-CAbJd_rrt90DHvdglYvP9RLqdDUVsFq28onw9xXJQ/viewform",children:"Join BCU Labs here"})}),(0,a.jsx)(i,{})]})}function d(e){let{children:s}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("header",{children:(0,a.jsx)(n,{})}),(0,a.jsx)("div",{children:s}),(0,a.jsx)("footer",{children:(0,a.jsx)(o,{})})]})}}}]);